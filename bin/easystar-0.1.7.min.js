var EasyStar=EasyStar||{};"undefined"==typeof window&&"undefined"!=typeof module&&module.exports&&(module.exports=EasyStar),EasyStar.Node=function(a,b,c,d,e){this.parent=a,this.x=b,this.y=c,this.costSoFar=d,this.simpleDistanceToTarget=e,this.bestGuessDistance=function(){return this.costSoFar+this.simpleDistanceToTarget}},EasyStar.Node.OPEN_LIST=0,EasyStar.Node.CLOSED_LIST=1,EasyStar.PriorityQueue=function(a,b){this.length=0;var c=[],d=!1;if(b==EasyStar.PriorityQueue.MAX_HEAP)d=!0;else{if(b!=EasyStar.PriorityQueue.MIN_HEAP)throw b+" not supported.";d=!1}this.insert=function(b){if(!b.hasOwnProperty(a))throw"Cannot insert "+b+" because it does not have a property by the name of "+a+".";c.push(b),this.length++,e(this.length-1)},this.getHighestPriorityElement=function(){return c[0]},this.shiftHighestPriorityElement=function(){if(0===this.length)throw"There are no more elements in your priority queue.";if(1===this.length){var a=c[0];return c=[],this.length=0,a}var b=c[0],d=c.pop();return this.length--,c[0]=d,f(0),b};var e=function(a){if(0!==a){var b=i(a);h(a,b)&&(g(a,b),e(b))}},f=function(a){var b=j(a),c=k(a);if(h(b,a))g(a,b),f(b);else if(h(c,a))g(a,c),f(c);else{if(0==a)return;f(0)}},g=function(a,b){var d=c[a];c[a]=c[b],c[b]=d},h=function(b,e){if(void 0===c[e]||void 0===c[b])return!1;var f,g;return"function"==typeof c[b][a]?(f=c[b][a](),g=c[e][a]()):(f=c[b][a],g=c[e][a]),d?f>g?!0:!1:g>f?!0:!1},i=function(a){return Math.floor(a/2)-1},j=function(a){return 2*a+1},k=function(a){return 2*a+2}},EasyStar.PriorityQueue.MAX_HEAP=0,EasyStar.PriorityQueue.MIN_HEAP=1,EasyStar.instance=function(){this.isDoneCalculating=!0,this.pointsToAvoid={},this.startX,this.callback,this.startY,this.endX,this.endY,this.nodeHash={},this.openList},EasyStar.js=function(){var a,b,c,d=10,e=14,f={},g={},h=[],i=Number.MAX_VALUE,j=!1;this.setAcceptableTiles=function(a){a instanceof Array?c=a:!isNaN(parseFloat(a))&&isFinite(a)&&(c=[a])},this.enableDiagonals=function(){j=!0},this.disableDiagonals=function(){j=!1},this.setGrid=function(b){a=b;for(var c=0;c<a.length;c++)for(var d=0;d<a[0].length;d++)g[a[c][d]]||(g[a[c][d]]=1)},this.setTileCost=function(a,b){g[a]=b},this.setIterationsPerCalculation=function(a){i=a},this.avoidAdditionalPoint=function(a,b){f[a+"_"+b]=1},this.stopAvoidingAdditionalPoint=function(a,b){delete f[a+"_"+b]},this.stopAvoidingAllAdditionalPoints=function(){f={}},this.findPath=function(b,e,f,g,i){if(void 0===c)throw"You can't set a path without first calling setAcceptableTiles() on EasyStar.";if(void 0===a)throw"You can't set a path without first calling setGrid() on EasyStar.";if(0>b||0>e||0>f||0>f||b>a[0].length-1||e>a.length-1||f>a[0].length-1||g>a.length-1)throw"Your start or end point is outside the scope of your grid.";b===f&&e===g&&i([]);for(var j=a[g][f],k=!1,m=0;m<c.length;m++)if(j===c[m]){k=!0;break}if(k===!1)return i(null),void 0;var n=new EasyStar.instance;n.openList=new EasyStar.PriorityQueue("bestGuessDistance",EasyStar.PriorityQueue.MIN_HEAP),n.isDoneCalculating=!1,n.nodeHash={},n.startX=b,n.startY=e,n.endX=f,n.endY=g,n.callback=i,n.openList.insert(l(n,n.startX,n.startY,null,d)),h.push(n)},this.calculate=function(){if(0!==h.length&&void 0!==a&&void 0!==c)for(b=0;i>b;b++){if(0===h.length)return;if(0!==h[0].openList.length){var f=h[0].openList.shiftHighestPriorityElement();if(f.list=EasyStar.Node.CLOSED_LIST,f.y>0&&(k(h[0],f,0,-1,d*g[a[f.y-1][f.x]]),h[0].isDoneCalculating===!0))h.shift();else if(f.x<a[0].length-1&&(k(h[0],f,1,0,d*g[a[f.y][f.x+1]]),h[0].isDoneCalculating===!0))h.shift();else if(f.y<a.length-1&&(k(h[0],f,0,1,d*g[a[f.y+1][f.x]]),h[0].isDoneCalculating===!0))h.shift();else if(f.x>0&&(k(h[0],f,-1,0,d*g[a[f.y][f.x-1]]),h[0].isDoneCalculating===!0))h.shift();else if(j){if(f.x>0&&f.y>0&&(k(h[0],f,-1,-1,e*g[a[f.y-1][f.x-1]]),h[0].isDoneCalculating===!0)){h.shift();continue}if(f.x<a[0].length-1&&f.y<a.length-1&&(k(h[0],f,1,1,e*g[a[f.y+1][f.x+1]]),h[0].isDoneCalculating===!0)){h.shift();continue}if(f.x<a[0].length-1&&f.y>0&&(k(h[0],f,1,-1,e*g[a[f.y-1][f.x+1]]),h[0].isDoneCalculating===!0)){h.shift();continue}if(f.x>0&&f.y<a.length-1&&(k(h[0],f,-1,1,e*g[a[f.y+1][f.x-1]]),h[0].isDoneCalculating===!0)){h.shift();continue}}}else h[0].callback(null),h.shift()}};var k=function(b,d,e,g,h){var i=d.x+e,j=d.y+g;if(b.endX===i&&b.endY===j){b.isDoneCalculating=!0;var k=[],m=0;k[m]={x:i,y:j},m++,k[m]={x:d.x,y:d.y},m++;for(var n=d.parent;null!=n;)k[m]={x:n.x,y:n.y},m++,n=n.parent;k.reverse(),b.callback(k)}if(void 0===f[i+"_"+j])for(var o=0;o<c.length;o++)if(a[j][i]===c[o]){var p=l(b,i,j,d,h);void 0===p.list?(p.list=EasyStar.Node.OPEN_LIST,b.openList.insert(p)):p.list===EasyStar.Node.OPEN_LIST&&d.costSoFar+h<p.costSoFar&&(p.costSoFar=d.costSoFar+h,p.parent=d);break}},l=function(a,b,c,d,e){if(void 0!==a.nodeHash[b+"_"+c])return a.nodeHash[b+"_"+c];var f=m(b,c,a.endX,a.endY);if(null!==d)var g=d.costSoFar+e;else g=f;var h=new EasyStar.Node(d,b,c,g,f);return a.nodeHash[b+"_"+c]=h,h},m=function(a,b,c,e){return Math.sqrt(Math.abs(c-a)*Math.abs(c-a)+Math.abs(e-b)*Math.abs(e-b))*d}},"function"==typeof define&&define.amd&&define("easystar",[],function(){return EasyStar});